# ğŸ“ Raspberry Pi æ¨¡çµ„åŒ–ç‰ˆæœ¬å®‰è£æŒ‡å—

## ğŸ“‹ **å®‰è£å‰æº–å‚™**

### **æª¢æŸ¥ç•¶å‰ç‰ˆæœ¬**
```bash
# SSH é€£æ¥åˆ°æ¨¹è“æ´¾
ssh future@raspberrypi

# æŸ¥çœ‹ç•¶å‰é …ç›®ç‹€æ…‹
cd ~/pi/subjective-clock
git status
git log --oneline -3
```

### **å‚™ä»½ç¾æœ‰ç‰ˆæœ¬** (é‡è¦ï¼)
```bash
# å‚™ä»½ç•¶å‰çš„ pi.html
cp pi.html pi.html.backup.$(date +%Y%m%d_%H%M%S)

# ç¢ºèªå‚™ä»½
ls -la pi.html*
```

---

## ğŸš€ **æ–¹æ³•ä¸€ï¼šGit åŒæ­¥æ›´æ–° (æ¨è–¦)**

### **æ­¥é©Ÿ 1: æ›´æ–°ä»£ç¢¼åº«**
```bash
# ç¢ºä¿åœ¨æ­£ç¢ºç›®éŒ„
cd ~/pi/subjective-clock

# å„²å­˜æœ¬åœ°ä¿®æ”¹ (å¦‚æœæœ‰)
git stash

# æ‹‰å–æœ€æ–°ç‰ˆæœ¬
git pull origin main

# æª¢æŸ¥æ˜¯å¦æˆåŠŸæ›´æ–°
git log --oneline -3
```

### **æ­¥é©Ÿ 2: é©—è­‰æ–°æ–‡ä»¶**
```bash
# æª¢æŸ¥çµ„ä»¶è³‡æ–™å¤¾æ˜¯å¦å­˜åœ¨
ls -la components/

# æ‡‰è©²çœ‹åˆ°:
# waiting-state.html
# loading-state.html  
# result-state.html
# component-loader.js

# æª¢æŸ¥æ¨¡çµ„åŒ–ä¸»æ–‡ä»¶
ls -la pi-modular.html
```

### **æ­¥é©Ÿ 3: å•Ÿç”¨æ¨¡çµ„åŒ–ç‰ˆæœ¬**
```bash
# é¸é …A: æ›¿æ›åŸæœ‰æ–‡ä»¶ (æ¨è–¦)
mv pi.html pi.html.original
mv pi-modular.html pi.html

# é¸é …B: æˆ–è€…ä¿æŒå…©å€‹ç‰ˆæœ¬ä¸¦å­˜
# ç›´æ¥ä½¿ç”¨ pi-modular.htmlï¼Œç„¡éœ€æ”¹å
```

### **æ­¥é©Ÿ 4: æ›´æ–°ä¸»æ§åˆ¶è…³æœ¬å¼•ç”¨**
```bash
# æª¢æŸ¥æ˜¯å¦éœ€è¦æ›´æ–° main_web_dsi.py ä¸­çš„ HTML æ–‡ä»¶è·¯å¾‘
nano ~/pi/subjective-clock/raspberrypi-dsi/main_web_dsi.py

# æŸ¥æ‰¾é€™ä¸€è¡Œ (å¤§ç´„åœ¨ç¬¬ 100 è¡Œå·¦å³):
# html_file = 'pi.html'

# å¦‚æœä½¿ç”¨é¸é …Bï¼Œéœ€è¦ä¿®æ”¹ç‚º:
# html_file = 'pi-modular.html'
```

---

## ğŸ”§ **æ–¹æ³•äºŒï¼šæ‰‹å‹•æ–‡ä»¶å‚³è¼¸**

### **å¾ä½ çš„é›»è…¦å‚³è¼¸æ–‡ä»¶**
```bash
# åœ¨ä½ çš„é›»è…¦ä¸Š (å¾é …ç›®æ ¹ç›®éŒ„åŸ·è¡Œ)

# 1. å‚³è¼¸çµ„ä»¶è³‡æ–™å¤¾
scp -r components/ future@raspberrypi:~/pi/subjective-clock/

# 2. å‚³è¼¸æ¨¡çµ„åŒ–ä¸»æ–‡ä»¶
scp pi-modular.html future@raspberrypi:~/pi/subjective-clock/

# 3. å‚³è¼¸é‡æ§‹ç‰ˆ JavaScript (å¦‚æœé‚„æ²’æœ‰)
scp pi-script-refactored.js future@raspberrypi:~/pi/subjective-clock/

# 4. å‚³è¼¸èªªæ˜æ–‡æª”
scp æ¨¡çµ„åŒ–çµæ§‹èªªæ˜.md future@raspberrypi:~/pi/subjective-clock/
```

### **åœ¨æ¨¹è“æ´¾ä¸Šæ•´ç†æ–‡ä»¶**
```bash
# SSH åˆ°æ¨¹è“æ´¾
ssh future@raspberrypi
cd ~/pi/subjective-clock

# å‚™ä»½ä¸¦æ›¿æ›
cp pi.html pi.html.backup
mv pi-modular.html pi.html

# é©—è­‰æ–‡ä»¶æ¬Šé™
chmod 644 pi.html
chmod 644 components/*.html
chmod 644 components/*.js
```

---

## âœ… **å®‰è£é©—è­‰**

### **æ­¥é©Ÿ 1: æª¢æŸ¥æ–‡ä»¶çµæ§‹**
```bash
# åœ¨æ¨¹è“æ´¾ä¸Šæª¢æŸ¥å®Œæ•´çµæ§‹
cd ~/pi/subjective-clock
tree -L 2

# æˆ–è€…ä½¿ç”¨ ls
ls -la
ls -la components/

# æ‡‰è©²çœ‹åˆ°é¡ä¼¼é€™æ¨£çš„çµæ§‹:
# pi.html (æ¨¡çµ„åŒ–ç‰ˆæœ¬)
# pi-script-refactored.js
# components/
#   â”œâ”€â”€ waiting-state.html
#   â”œâ”€â”€ loading-state.html
#   â”œâ”€â”€ result-state.html
#   â””â”€â”€ component-loader.js
```

### **æ­¥é©Ÿ 2: æ¸¬è©¦ Web æœå‹™å™¨**
```bash
# å¦‚æœæœ‰é‹è¡Œ web æœå‹™å™¨ï¼Œé‡å•Ÿå®ƒ
sudo systemctl restart nginx
# æˆ–è€…
sudo systemctl restart apache2

# æˆ–è€…å¦‚æœä½¿ç”¨ Python é–‹ç™¼æœå‹™å™¨
pkill -f "python.*http.server"
cd ~/pi/subjective-clock
python3 -m http.server 8000 &
```

### **æ­¥é©Ÿ 3: ç€è¦½å™¨æ¸¬è©¦**
```bash
# åœ¨æ¨¹è“æ´¾æœ¬åœ°ç€è¦½å™¨ä¸­è¨ªå•
# http://localhost:8000/pi.html
# æˆ–è€…
# http://raspberrypi.local:8000/pi.html

# æª¢æŸ¥ç€è¦½å™¨æ§åˆ¶å°ï¼Œæ‡‰è©²çœ‹åˆ°:
# ğŸ“¦ çµ„ä»¶è¼‰å…¥å™¨å·²åˆå§‹åŒ–
# ğŸ”˜ ç­‰å¾…ç‹€æ…‹çµ„ä»¶å·²è¼‰å…¥
# â³ è¼‰å…¥ç‹€æ…‹çµ„ä»¶å·²è¼‰å…¥
# ğŸ“Š çµæœç‹€æ…‹çµ„ä»¶å·²è¼‰å…¥
# ğŸ‰ æ‰€æœ‰çµ„ä»¶å·²è¼‰å…¥å®Œæˆ
```

---

## ğŸ”§ **ä¸»æ§åˆ¶ç¨‹å¼æ›´æ–°**

### **æª¢æŸ¥ main_web_dsi.py é…ç½®**
```bash
cd ~/pi/subjective-clock/raspberrypi-dsi
nano main_web_dsi.py

# æŸ¥æ‰¾ HTML æ–‡ä»¶è·¯å¾‘é…ç½® (å¤§ç´„ç¬¬ 100-120 è¡Œ)
# ç¢ºä¿æŒ‡å‘æ­£ç¢ºçš„ HTML æ–‡ä»¶
```

å¦‚æœç™¼ç¾é…ç½®éœ€è¦æ›´æ–°ï¼š
```python
# èˆŠçš„é…ç½®å¯èƒ½æ˜¯:
# html_file = 'pi.html'

# å¦‚æœä½ ä½¿ç”¨äº†ä¸åŒçš„æ–‡ä»¶åï¼Œæ›´æ–°ç‚º:
# html_file = 'pi-modular.html'  # æˆ–è€…ä¿æŒ 'pi.html' å¦‚æœå·²ç¶“æ›¿æ›
```

### **é‡å•Ÿä¸»æ§åˆ¶ç¨‹å¼**
```bash
# å¦‚æœæœ‰ autostart æœå‹™
sudo systemctl restart wakeupclock

# æˆ–è€…æ‰‹å‹•é‡å•Ÿ
pkill -f main_web_dsi.py
cd ~/pi/subjective-clock/raspberrypi-dsi
python3 main_web_dsi.py &
```

---

## ğŸ§ª **åŠŸèƒ½æ¸¬è©¦**

### **æ¸¬è©¦çµ„ä»¶è¼‰å…¥**
```bash
# åœ¨ç€è¦½å™¨æ§åˆ¶å°ä¸­åŸ·è¡Œ (F12 é–‹å•Ÿæ§åˆ¶å°)
```
```javascript
// æª¢æŸ¥çµ„ä»¶è¼‰å…¥ç‹€æ…‹
console.log('çµ„ä»¶è¼‰å…¥ç‹€æ…‹:', {
    waiting: window.componentLoader.isLoaded('./components/waiting-state.html', '.main-display'),
    loading: window.componentLoader.isLoaded('./components/loading-state.html', '.main-display'),
    result: window.componentLoader.isLoaded('./components/result-state.html', '.main-display')
});

// æª¢æŸ¥ç®¡ç†å™¨æ˜¯å¦å°±ç·’
console.log('ç®¡ç†å™¨ç‹€æ…‹:', {
    resultManager: !!window.resultStateManager,
    loadingManager: !!window.loadingStateManager,
    componentLoader: !!window.componentLoader
});
```

### **æ¸¬è©¦é é¢åˆ‡æ›**
```javascript
// æ¸¬è©¦ç‹€æ…‹åˆ‡æ› (åœ¨ç€è¦½å™¨æ§åˆ¶å°)
StateManager.setState('waiting');   // æ‡‰è©²é¡¯ç¤º Press Button é é¢
StateManager.setState('loading');   // æ‡‰è©²é¡¯ç¤º Locating é é¢  
StateManager.setState('result');    // æ‡‰è©²é¡¯ç¤º Result é é¢
```

### **æ¸¬è©¦éš±è—æŒ‰éˆ•**
```javascript
// é¡¯ç¤ºéš±è—æŒ‰éˆ• (åœ¨ç€è¦½å™¨æ§åˆ¶å°)
hiddenButtonControl.show();

// æˆ–è€…ä½¿ç”¨å¿«æ·éµ
// æŒ‰ ESC éµ - æ‡‰è©²è‡¨æ™‚é¡¯ç¤ºç·Šæ€¥æŒ‰éˆ• 5 ç§’
// æŒ‰ Ctrl + H - æ‡‰è©²è§¸ç™¼ startTheDay()
```

---

## ğŸš¨ **æ•…éšœæ’é™¤**

### **å•é¡Œ 1: çµ„ä»¶è¼‰å…¥å¤±æ•—**
```bash
# æª¢æŸ¥æ–‡ä»¶æ¬Šé™
chmod -R 644 components/
chmod 755 components/

# æª¢æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la components/
cat components/waiting-state.html | head -10
```

### **å•é¡Œ 2: JavaScript éŒ¯èª¤**
```bash
# æª¢æŸ¥ pi-script-refactored.js æ˜¯å¦å­˜åœ¨
ls -la pi-script-refactored.js

# å¦‚æœä¸å­˜åœ¨ï¼Œå¾ä½ çš„é›»è…¦å‚³è¼¸
scp pi-script-refactored.js future@raspberrypi:~/pi/subjective-clock/
```

### **å•é¡Œ 3: åœ°åœ–ä¸é¡¯ç¤º**
åœ¨ç€è¦½å™¨æ§åˆ¶å°æª¢æŸ¥ï¼š
```javascript
// æª¢æŸ¥åœ°åœ–ç‹€æ…‹
console.log('åœ°åœ–ç‹€æ…‹:', {
    leafletLoaded: typeof L !== 'undefined',
    mapInstance: !!window.mainInteractiveMap,
    mapContainer: !!document.getElementById('mainMapContainer')
});
```

### **å•é¡Œ 4: å›é€€åˆ°åŸå§‹ç‰ˆæœ¬**
```bash
# å¦‚æœæœ‰å•é¡Œï¼Œå¿«é€Ÿå›é€€
cd ~/pi/subjective-clock
mv pi.html pi-modular.html.backup
mv pi.html.backup pi.html

# é‡å•Ÿæœå‹™
sudo systemctl restart wakeupclock
```

---

## ğŸ“Š **å®‰è£å®Œæˆæª¢æŸ¥æ¸…å–®**

- [ ] âœ… çµ„ä»¶è³‡æ–™å¤¾å­˜åœ¨: `components/`
- [ ] âœ… å››å€‹çµ„ä»¶æ–‡ä»¶éƒ½å­˜åœ¨ä¸”å¯è®€
- [ ] âœ… æ¨¡çµ„åŒ–ä¸»æ–‡ä»¶å­˜åœ¨: `pi.html` æˆ– `pi-modular.html`
- [ ] âœ… é‡æ§‹ç‰ˆ JavaScript å­˜åœ¨: `pi-script-refactored.js`
- [ ] âœ… ç€è¦½å™¨æ§åˆ¶å°ç„¡çµ„ä»¶è¼‰å…¥éŒ¯èª¤
- [ ] âœ… å¯ä»¥çœ‹åˆ° "Press The Button" é é¢
- [ ] âœ… éš±è—æŒ‰éˆ•åŠŸèƒ½æ­£å¸¸ (ESC éµæ¸¬è©¦)
- [ ] âœ… ä¸»æ§åˆ¶ç¨‹å¼é‡å•ŸæˆåŠŸ
- [ ] âœ… GPIO æŒ‰éˆ•åŠŸèƒ½æ¸¬è©¦æ­£å¸¸

---

## ğŸ‰ **å®Œæˆï¼**

ç¾åœ¨ä½ çš„æ¨¹è“æ´¾ä¸Šé‹è¡Œçš„æ˜¯**å…¨æ–°çš„æ¨¡çµ„åŒ–ç‰ˆæœ¬**ï¼

### **ä¸»è¦å„ªå‹¢**
- ğŸ”§ **æ›´å®¹æ˜“ç¶­è­·**: æ¯å€‹é é¢éƒ½æ˜¯ç¨ç«‹æ–‡ä»¶
- ğŸ› **æ›´å®¹æ˜“èª¿è©¦**: éŒ¯èª¤éš”é›¢åœ¨ç‰¹å®šçµ„ä»¶
- ğŸš€ **æ›´å®¹æ˜“æ“´å±•**: å¯ä»¥è¼•é¬†æ·»åŠ æ–°é é¢çµ„ä»¶
- ğŸ“± **æ›´å¥½çš„é–‹ç™¼é«”é©—**: ä¿®æ”¹çµ„ä»¶ç«‹å³ç”Ÿæ•ˆ

### **æ—¥å¸¸ç¶­è­·**
```bash
# ä¿®æ”¹ Press Button é é¢
nano ~/pi/subjective-clock/components/waiting-state.html

# ä¿®æ”¹è¼‰å…¥é é¢  
nano ~/pi/subjective-clock/components/loading-state.html

# ä¿®æ”¹çµæœé é¢
nano ~/pi/subjective-clock/components/result-state.html
```

å¦‚æœé‡åˆ°ä»»ä½•å•é¡Œï¼Œå¯ä»¥æŸ¥çœ‹ `æ¨¡çµ„åŒ–çµæ§‹èªªæ˜.md` ç²å–æ›´è©³ç´°çš„ä¿¡æ¯ï¼ğŸš€âœ¨